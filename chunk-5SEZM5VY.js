import{a as g}from"./chunk-A53FJZFH.js";import{$d as Ce,Ca as I,Da as z,Ea as J,F as q,G as X,Gb as te,Ha as H,Ia as me,Ka as b,L as p,M as ne,Ma as Q,Na as T,O as m,Oa as x,Ra as ve,S as F,Sa as _e,T as w,Ta as $,U as se,Ua as K,V as ae,W as le,Wc as N,Xc as D,Y as R,Z as j,Zb as ye,_ as ce,a as f,aa as de,bb as ee,ca as k,ea as v,g as O,ga as pe,ha as E,i as re,ia as B,j as P,m as G,pa as he,ra as A,rb as L,sa as ue,se as Pe,ta as _,va as ge,vb as be,w as Z,wa as fe,wb as xe,y as Y,z as u,zb as De}from"./chunk-7I3W2GY5.js";var Ge=(()=>{let r=class r{transform(e){return Math.round(e)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275pipe=le({name:"ngxRound",type:r,pure:!0});let t=r;return t})();var Ie=[[["ngx-dropzone-label"]]],ze=["ngx-dropzone-label"];function Ee(t,r){if(t&1){let o=H();I(0,"ngx-dropzone-remove-badge",1),b("click",function(i){R(o);let n=Q();return j(n._remove(i))}),z()}}var Be=["fileInput"],Ae=[[["ngx-dropzone-preview"]],"*",[["ngx-dropzone-label"]]],He=["ngx-dropzone-preview","*","ngx-dropzone-label"];function Te(t,r){t&1&&x(0,2,["*ngIf","!_hasPreviews"])}function Le(t,r){if(t&1){let o=H();I(0,"ngx-dropzone-remove-badge",2),b("click",function(i){R(o);let n=Q();return j(n._remove(i))}),z()}}var lt=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275dir=ae({type:t,selectors:[["ngx-dropzone-label"]]}),t})();function y(t){return t!=null&&`${t}`!="false"}function Ue(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))?Number(t):null}var Ne=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=w({type:t,selectors:[["ngx-dropzone-remove-badge"]],decls:3,vars:0,consts:[["x1","0","y1","0","x2","10","y2","10"],["x1","0","y1","10","x2","10","y2","0"]],template:function(o,e){o&1&&(ce(),I(0,"svg"),J(1,"line",0)(2,"line",1),z())},styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:22px;width:22px;position:absolute;top:5px;right:5px;border-radius:50%;background:#bbb;color:#333;cursor:pointer}[_nghost-%COMP%]:hover{background:#aeaeae}[_nghost-%COMP%] > svg[_ngcontent-%COMP%]{height:10px;width:10px}[_nghost-%COMP%] > svg[_ngcontent-%COMP%] > line[_ngcontent-%COMP%]{stroke-width:2px;stroke:#fff}"]}),t})(),ie=function(t){return t[t.BACKSPACE=8]="BACKSPACE",t[t.DELETE=46]="DELETE",t}(ie||{}),oe=(()=>{class t{constructor(o){this.sanitizer=o,this._removable=!1,this.removed=new v,this.tabIndex=0}set file(o){this._file=o}get file(){return this._file}get removable(){return this._removable}set removable(o){this._removable=y(o)}keyEvent(o){switch(o.keyCode){case ie.BACKSPACE:case ie.DELETE:this.remove();break;default:break}}get hostStyle(){return this.sanitizer.bypassSecurityTrustStyle(`
			display: flex;
			height: 140px;
			min-height: 140px;
			min-width: 180px;
			max-width: 180px;
			justify-content: center;
			align-items: center;
			padding: 0 20px;
			margin: 10px;
			border-radius: 5px;
			position: relative;
		`)}_remove(o){o.stopPropagation(),this.remove()}remove(){this._removable&&this.removed.next(this.file)}readFile(){return O(this,null,function*(){return new Promise((o,e)=>{let i=new FileReader;if(i.onload=n=>{o(n.target.result)},i.onerror=n=>{console.error(`FileReader failed on file ${this.file.name}.`),e(n)},!this.file)return e("No file to read. Please provide a file using the [file] Input property.");i.readAsDataURL(this.file)})})}}return t.\u0275fac=function(o){return new(o||t)(B(te))},t.\u0275cmp=w({type:t,selectors:[["ngx-dropzone-preview"]],hostVars:3,hostBindings:function(o,e){o&1&&b("keyup",function(n){return e.keyEvent(n)}),o&2&&(me("tabindex",e.tabIndex),fe(e.hostStyle))},inputs:{file:"file",removable:"removable"},outputs:{removed:"removed"},ngContentSelectors:ze,decls:2,vars:1,consts:[[3,"click",4,"ngIf"],[3,"click"]],template:function(o,e){o&1&&(T(Ie),x(0),A(1,Ee,1,0,"ngx-dropzone-remove-badge",0)),o&2&&(E(),_("ngIf",e.removable))},dependencies:[Ne,L],styles:["[_nghost-%COMP%]{background-image:linear-gradient(to top,#ededed,#efefef,#f1f1f1,#f4f4f4,#f6f6f6)}[_nghost-%COMP%]:hover, [_nghost-%COMP%]:focus{background-image:linear-gradient(to top,#e3e3e3,#ebeaea,#e8e7e7,#ebeaea,#f4f4f4);outline:0}[_nghost-%COMP%]:hover   ngx-dropzone-remove-badge[_ngcontent-%COMP%], [_nghost-%COMP%]:focus   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]     ngx-dropzone-label{overflow-wrap:break-word}"]}),t})(),we=(()=>{class t{parseFileList(o,e,i,n){let s=[],a=[];for(let c=0;c<o.length;c++){let d=o.item(c);if(!this.isAccepted(d,e)){this.rejectFile(a,d,"type");continue}if(i&&d.size>i){this.rejectFile(a,d,"size");continue}if(!n&&s.length>=1){this.rejectFile(a,d,"no_multiple");continue}s.push(d)}return{addedFiles:s,rejectedFiles:a}}isAccepted(o,e){if(e==="*")return!0;let i=e.split(",").map(l=>l.toLowerCase().trim()),n=o.type.toLowerCase(),s=o.name.toLowerCase();return!!i.find(l=>l.endsWith("/*")?n.split("/")[0]===l.split("/")[0]:l.startsWith(".")?s.endsWith(l):l==n)}rejectFile(o,e,i){let n=e;n.reason=i,o.push(n)}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac}),t})(),ct=(()=>{class t{constructor(o){this.service=o,this.change=new v,this.accept="*",this._disabled=!1,this._multiple=!0,this._maxFileSize=void 0,this._expandable=!1,this._disableClick=!1,this._processDirectoryDrop=!1,this._isHovered=!1}get _hasPreviews(){return!!this._previewChildren.length}get disabled(){return this._disabled}set disabled(o){this._disabled=y(o),this._isHovered&&(this._isHovered=!1)}get multiple(){return this._multiple}set multiple(o){this._multiple=y(o)}get maxFileSize(){return this._maxFileSize}set maxFileSize(o){this._maxFileSize=Ue(o)}get expandable(){return this._expandable}set expandable(o){this._expandable=y(o)}get disableClick(){return this._disableClick}set disableClick(o){this._disableClick=y(o)}get processDirectoryDrop(){return this._processDirectoryDrop}set processDirectoryDrop(o){this._processDirectoryDrop=y(o)}_onClick(){this.disableClick||this.showFileSelector()}_onDragOver(o){this.disabled||(this.preventDefault(o),this._isHovered=!0)}_onDragLeave(){this._isHovered=!1}_onDrop(o){if(!this.disabled)if(this.preventDefault(o),this._isHovered=!1,!this.processDirectoryDrop||!DataTransferItem.prototype.webkitGetAsEntry)this.handleFileDrop(o.dataTransfer.files);else{let e=o.dataTransfer.items;if(e.length>0){let i=[],n=[];for(let a=0;a<e.length;a++){let l=e[a].webkitGetAsEntry();l.isFile?i.push(o.dataTransfer.files[a]):l.isDirectory&&n.push(l)}let s=new DataTransfer;if(i.forEach(a=>{s.items.add(a)}),!n.length&&s.items.length&&this.handleFileDrop(s.files),n.length){let a=[];for(let l of n)a.push(this.extractFilesFromDirectory(l));Promise.all(a).then(l=>{l.reduce((c,d)=>[...c,...d]).forEach(c=>{s.items.add(c)}),this.handleFileDrop(s.files)})}}}}extractFilesFromDirectory(o){function e(i){return O(this,null,function*(){try{return yield new Promise((n,s)=>i.file(n,s))}catch(n){console.log("Error converting a fileEntry to a File: ",n)}})}return new Promise((i,n)=>{let s=[],a=o.createReader(),l=()=>{a.readEntries(c=>O(this,null,function*(){if(!c.length)i(s);else{let d=c.filter(W=>W.isFile);for(let W of d){let ke=yield e(W);s.push(ke)}l()}}))};l()})}showFileSelector(){this.disabled||this._fileInput.nativeElement.click()}_onFilesSelected(o){let e=o.target.files;this.handleFileDrop(e),this._fileInput.nativeElement.value="",this.preventDefault(o)}handleFileDrop(o){let e=this.service.parseFileList(o,this.accept,this.maxFileSize,this.multiple);this.change.next({addedFiles:e.addedFiles,rejectedFiles:e.rejectedFiles,source:this})}preventDefault(o){o.preventDefault(),o.stopPropagation()}}return t.\u0275fac=function(o){return new(o||t)(B(we,2))},t.\u0275cmp=w({type:t,selectors:[["ngx-dropzone"],["","ngx-dropzone",""]],contentQueries:function(o,e,i){if(o&1&&ve(i,oe,5),o&2){let n;$(n=K())&&(e._previewChildren=n)}},viewQuery:function(o,e){if(o&1&&_e(Be,7),o&2){let i;$(i=K())&&(e._fileInput=i.first)}},hostVars:8,hostBindings:function(o,e){o&1&&b("click",function(){return e._onClick()})("dragover",function(n){return e._onDragOver(n)})("dragleave",function(){return e._onDragLeave()})("drop",function(n){return e._onDrop(n)}),o&2&&ge("ngx-dz-disabled",e.disabled)("expandable",e.expandable)("unclickable",e.disableClick)("ngx-dz-hovered",e._isHovered)},inputs:{accept:"accept",disabled:"disabled",multiple:"multiple",maxFileSize:"maxFileSize",expandable:"expandable",disableClick:"disableClick",processDirectoryDrop:"processDirectoryDrop",id:"id",ariaLabel:[F.None,"aria-label","ariaLabel"],ariaLabelledby:[F.None,"aria-labelledby","ariaLabelledby"],ariaDescribedBy:[F.None,"aria-describedby","ariaDescribedBy"]},outputs:{change:"change"},features:[ee([we])],ngContentSelectors:He,decls:5,vars:8,consts:[["fileInput",""],["type","file",3,"change","id","multiple","accept","disabled"],[4,"ngIf"]],template:function(o,e){if(o&1){let i=H();T(Ae),I(0,"input",1,0),b("change",function(s){return R(i),j(e._onFilesSelected(s))}),z(),A(2,Te,1,0,"ng-content",2),x(3),x(4,1)}o&2&&(_("id",e.id)("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled),ue("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledby)("aria-describedby",e.ariaDescribedBy),E(2),_("ngIf",!e._hasPreviews))},dependencies:[L],styles:["[_nghost-%COMP%]{display:flex;align-items:center;height:180px;background:#fff;cursor:pointer;color:#717386;border:2px dashed #717386;border-radius:5px;font-size:16px;overflow-x:auto}.ngx-dz-hovered[_nghost-%COMP%]{border-style:solid}.ngx-dz-disabled[_nghost-%COMP%]{opacity:.5;cursor:no-drop;pointer-events:none}.expandable[_nghost-%COMP%]{overflow:hidden;height:unset;min-height:180px;flex-wrap:wrap}.unclickable[_nghost-%COMP%]{cursor:default}[_nghost-%COMP%]     ngx-dropzone-label{text-align:center;z-index:10;margin:10px auto}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus +   ngx-dropzone-label{outline:1px dotted #000;outline:-webkit-focus-ring-color auto 5px}"]}),t})(),dt=(()=>{class t extends oe{constructor(o){super(o),this.defaultImgLoading="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBiYWNrZ3JvdW5kOiByZ2IoMjQxLCAyNDIsIDI0Mykgbm9uZSByZXBlYXQgc2Nyb2xsIDAlIDAlOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgd2lkdGg9IjIyNHB4IiBoZWlnaHQ9IjIyNHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIxNCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2U9IiM4NWEyYjYiIHN0cm9rZS1kYXNoYXJyYXk9IjIxLjk5MTE0ODU3NTEyODU1MiAyMS45OTExNDg1NzUxMjg1NTIiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+CiAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIGR1cj0iMS4xNjI3OTA2OTc2NzQ0MTg0cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGtleVRpbWVzPSIwOzEiIHZhbHVlcz0iMCA1MCA1MDszNjAgNTAgNTAiPjwvYW5pbWF0ZVRyYW5zZm9ybT4KPC9jaXJjbGU+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjEwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZT0iI2JiY2VkZCIgc3Ryb2tlLWRhc2hhcnJheT0iMTUuNzA3OTYzMjY3OTQ4OTY2IDE1LjcwNzk2MzI2Nzk0ODk2NiIgc3Ryb2tlLWRhc2hvZmZzZXQ9IjE1LjcwNzk2MzI2Nzk0ODk2NiIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICA8YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgZHVyPSIxLjE2Mjc5MDY5NzY3NDQxODRzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIga2V5VGltZXM9IjA7MSIgdmFsdWVzPSIwIDUwIDUwOy0zNjAgNTAgNTAiPjwvYW5pbWF0ZVRyYW5zZm9ybT4KPC9jaXJjbGU+CjwhLS0gW2xkaW9dIGdlbmVyYXRlZCBieSBodHRwczovL2xvYWRpbmcuaW8vIC0tPjwvc3ZnPg==",this.imageSrc=this.sanitizer.bypassSecurityTrustUrl(this.defaultImgLoading)}set file(o){this._file=o,this.renderImage()}get file(){return this._file}ngOnInit(){this.renderImage()}renderImage(){this.readFile().then(o=>setTimeout(()=>this.imageSrc=o)).catch(o=>console.error(o))}}return t.\u0275fac=function(o){return new(o||t)(B(te))},t.\u0275cmp=w({type:t,selectors:[["ngx-dropzone-image-preview"]],inputs:{file:"file"},features:[ee([{provide:oe,useExisting:t}]),he],ngContentSelectors:ze,decls:3,vars:2,consts:[[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(o,e){o&1&&(T(Ie),J(0,"img",0),x(1),A(2,Le,1,0,"ngx-dropzone-remove-badge",1)),o&2&&(_("src",e.imageSrc,pe),E(2),_("ngIf",e.removable))},dependencies:[Ne,L],styles:["[_nghost-%COMP%]{min-width:unset!important;max-width:unset!important;padding:0!important}[_nghost-%COMP%]:hover   img[_ngcontent-%COMP%], [_nghost-%COMP%]:focus   img[_ngcontent-%COMP%]{opacity:.7}[_nghost-%COMP%]:hover   ngx-dropzone-remove-badge[_ngcontent-%COMP%], [_nghost-%COMP%]:focus   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   ngx-dropzone-remove-badge[_ngcontent-%COMP%]{opacity:0}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{max-height:100%;border-radius:5px;opacity:.8}[_nghost-%COMP%]     ngx-dropzone-label{position:absolute;overflow-wrap:break-word}"]}),t})();var pt=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=se({type:t}),t.\u0275inj=ne({imports:[[be]]}),t})();function V(t){return{message:t?(t.error&&t.error.Message)??(t.error&&t.error.message)??t.Message??t.message??t.statusText:"undefined error",statusCode:t?(t.error&&t.error.statusCode)??t.error.statusCode??t.status:500,success:!1}}var U=class{};var Me=(()=>{let r=class r{constructor(e){this.injector=e,this.useCredential=g?.USE_CREDENTIAL||!1,this.apiPath=g?.API_PATH||"/api/",this.header={headers:this.authHeader},this.getFileUrl=i=>this.apiPath+i,this.provider=e.get(De)}get token(){return document.cookie.jwt??sessionStorage.getItem("jwt")??localStorage.getItem("jwt")}get authHeader(){return new xe().set("Authorization",`Bearer ${this.token}`).set("Content-Type","application/json").set("Accept","application/json")}getRequestData(e){return e&&e.items&&delete e.items,new Object({withCredentials:this.useCredential,headers:this.authHeader,params:e})}getOne(e,i){let n=this.apiPath+e+"/"+i;return this.provider.get(n,this.getRequestData()).pipe(u(1))}getFullData(e,i){return this.provider.get(this.apiPath+e,this.getRequestData(i)).pipe(u(1))}getAll(e,i,n){let s=`${n?"/Paginated":""}`;return this.provider.get(this.apiPath+e+s,this.getRequestData(i)).pipe(u(1))}create(e,i){return this.provider.post(this.apiPath+e,i,this.getRequestData({})).pipe(u(1))}update(e,i){let n=this.apiPath+e+"/"+i.id;return this.provider.put(n,i,this.getRequestData({})).pipe(u(1))}delete(e,i){let n=this.apiPath+e+"/"+i;return this.provider.delete(n,this.getRequestData()).pipe(u(1))}fileData(e,i){let n=new Promise((s,a)=>{let l=new XMLHttpRequest;l.open("POST",this.apiPath+e,!0),l.setRequestHeader("Authorization",`Bearer ${this.token}`);function c(){s(JSON.parse(l.response))}l.onload=c,l.send(i)});return new re(s=>{n.then(a=>s.next(a)).catch(a=>V(a))})}};r.\u0275fac=function(i){return new(i||r)(m(k))},r.\u0275prov=p({token:r,factory:r.\u0275fac});let t=r;return t})();var Ve=function(t){return t[t.NONE=0]="NONE",t[t.USER=1]="USER",t[t.PRODUCT=2]="PRODUCT",t[t.CATEGORY=3]="CATEGORY",t}(Ve||{});var Se=function(t){return t[t.primary=0]="primary",t[t.success=1]="success",t[t.info=2]="info",t[t.warning=3]="warning",t[t.danger=4]="danger",t}(Se||{}),C=function(t){return t[t.PRIMARY=0]="PRIMARY",t[t.SUCCESS=1]="SUCCESS",t[t.INFO=2]="INFO",t[t.WARNING=3]="WARNING",t[t.DANGER=4]="DANGER",t}(C||{}),S=t=>Se[t];var Oe=(()=>{let r=class r{constructor(e){this.toastrService=e,this.notifyParams={},this.positions=[D.TOP_RIGHT,D.TOP_LEFT,D.BOTTOM_LEFT,D.BOTTOM_RIGHT,N.TOP_END,N.TOP_START,N.BOTTOM_END,N.BOTTOM_START],this.getDefaultValues=()=>(this.loadDefaultValues(),Object.assign({position:this.position,duration:this.duration,content:this.content,status:this.status,title:this.title})),this.loadDefaultValues()}loadDefaultValues(){this.index=0,this.hasIcon=!0,this.destroyByClick=!0,this.preventDuplicates=!1,this.duration=2,this.title="Info",this.status="primary",this.content="Loading data..",this.position=D.TOP_RIGHT,this.types=["primary","success","info","warning","danger"]}show(e){e&&Object.keys(e).forEach(i=>{this[i]&&(this[i]=e[i])}),this.showToast(this.status,this.title,this.content),this.loadDefaultValues()}showToast(e,i,n){let s=i?`. ${i}`:"",a={status:e,hasIcon:this.hasIcon,position:this.position,duration:this.duration*1e3,destroyByClick:this.destroyByClick,preventDuplicates:this.preventDuplicates};this.toastrService.show(n,++this.index+s,a)}validateNetwork(e){let i=e?.statusCode||e?.status;return e&&i&&i!=504?!0:i==404?this.showError(e?.message,"Route Not Found"):(this.notifyParams.status=S(C.WARNING),this.notifyParams.content="Verifique sua conexao",this.notifyParams.title="Indisponivel",this.notifyParams.duration=10,this.show(this.notifyParams),!1)}showSuccess(e="",i=""){this.notifyParams.status=S(C.SUCCESS),this.notifyParams.content=e||"Sucesso ao carregar dados",this.notifyParams.title=i||"Sucesso",this.notifyParams.duration=2,this.show(this.notifyParams)}showNoData(){this.notifyParams.status=S(C.WARNING),this.notifyParams.content="Sem dados para mostrar",this.notifyParams.title="Aviso!",this.notifyParams.duration=10,this.show(this.notifyParams)}showError(e,i,n=""){this.notifyParams.status=S(C.DANGER),this.notifyParams.title=n+" - "+i,this.notifyParams.content=e,this.notifyParams.duration=30,this.show(this.notifyParams)}openRandomToast(){let e=[{title:"WTF?",body:"Titles are not always needed"},{title:null,body:"We rock at Angular"},{title:null,body:"Notify rock!"}],i=Math.floor(Math.random()*this.types.length),n=Math.floor(Math.random()*e.length),s=this.types[i],a=e[n];this.showToast(s,a.title,a.body)}};r.\u0275fac=function(i){return new(i||r)(m(Ce))},r.\u0275prov=p({token:r,factory:r.\u0275fac});let t=r;return t})();var Fe=(()=>{let r=class r extends Me{constructor(e){super(e),this.injector=e,this.delay=500,this.url="",this.hasDataChanges=new v,this.hasItemChanges=new v,this.getAllBySubject=new P,this.getOneBySubject=new P,this.endSubscription=new P,this.end2Subscription=new P,this.initialized=!1,this.getApiPath=()=>this.apiPath,this._handlerComplete=()=>console.info("complete"),this._handlerError=(i,n=0,s=!1)=>{this.notify.validateNetwork(i)&&((s||i.error)&&(i=V(i)),this.notify.showError(i.message||"Falha","Falha",i.statusCode),console.error("Error Type",n,"-",i))},this._handlerNext=i=>{if(i&&i.error)return this._handlerError(i);!i||!i.success||(this.getPaginationData(i.content),(!this.data||!this.data.length)&&this.notify.showNoData(),this.updateSourceData(this.sourceData),this.updateSource(this.data),this.notify.showSuccess())},this._handlerOneNext=i=>{if(i&&i.error)return this._handlerError(i);!i||!i.success||(this.data=i.content,this.hasItemChanges.emit(this.data),this.data||this.notify.showNoData(),this.notify.showSuccess())},this.convertDataToTreeNode=i=>i&&i.length&&i.map(n=>({data:n}))||[],this.dataSourceBuilder=e.get(Pe),this.notify=e.get(Oe),this.router=e.get(ye),this.pagination=new U,this.filter={key:"",field:""},this.getOneBySubject.pipe(Y(this.delay),X(this.end2Subscription),q(i=>this._switchMapHandler(this.getDataByID(i)))).subscribe({next:this._handlerOneNext,error:this._handlerError}),this.getAllBySubject.pipe(Y(this.delay),X(this.endSubscription),q(i=>this._switchMapHandler(this.getDataRequest(i)))).subscribe({next:this._handlerNext,error:this._handlerError})}ngOnInit(){this.initialized||this.getAllBySubject.next(),this.initialized=!0}clearFilter(){this.filter={key:"",field:"",use:!1},this.pagination=f(f({},this.pagination),this.filter)}clearFilterAndRedirect(e){this.filter={key:"",field:""},this.pagination=f(f({},this.pagination),this.filter),e?.length&&this.router.navigate([e])}setFilter(e){if(e){let{field:i,key:n,use:s}=e;this.filter.field=i,this.filter.key=n,this.filter.use=!!(i?.length&&n?.length)}this.filter.use&&(this.pagination=f(f({},this.pagination),this.filter),this.getAllBySubject.next(this.pagination))}setPagination(e={}){this.pagination.page=e&&e.page||1,this.pagination.size=e&&e.size||5}onFilterConfirm(e,i){e?(this.setFilter({field:parseInt(e)?"code":"name",key:e}),i?.length&&this.router.navigate([i])):console.error("Invalid Key to Search")}refreshFullData(){return this.getFullDataRequest().pipe(u(1),Z(e=>G(this._handlerError(e,2,!0))))}refreshData(e){this.getAllBySubject.next(e||this.pagination)}getOneData(e){this.getOneBySubject.next(e)}createData(e){return this._simpleRequestHandle(this.createDataRequest(e),h.Notify,e)}updateData(e){return this._simpleRequestHandle(this.updateDataRequest(e),h.ReloadOneData,e)}deleteData(e){return this._simpleRequestHandle(this.deleteDataRequest(e),h.ReloadMultiData,e)}reloadHandler(e=h.None,i){switch(e){case h.None:return;case h.Notify:this.notify.showSuccess();break;case h.ReloadOneData:this.getOneData(i.id||i);break;case h.ReloadMultiData:this.refreshData();break;default:this.notify.showSuccess()}}_simpleRequestHandle(e,i=h.None,n){return this._switchMapHandler(e).subscribe({next:()=>this.reloadHandler(i,n),error:s=>this._handlerError(s)})}_switchMapHandler(e){return e.pipe(Z(i=>G(this._handlerError(i,2,!0))))}getDataByID(e){return super.getOne(this.url,e)}getDataRequest(e){return super.getAll(this.url,e,!0)}getFullDataRequest(){return super.getFullData(this.url)}createDataRequest(e){return super.create(this.url,e)}updateDataRequest(e){return super.update(this.url,e)}deleteDataRequest(e){return super.delete(this.url,e)}getPaginationData(e){this.data=e&&e.items||[],this.hasDataChanges.emit(this.data),this.pagination=e}uploadFile(e,i){return super.fileData(this.url+i,e)}updateSource(e){this.source=this.dataSourceBuilder.create(this.convertDataToTreeNode(e||this.source))}updateSourceData(e){this.sourceData=e||this.sourceData}getAttachments(e,i,n){let s={typeKey:e,valueKey:i,first:!n};return super.getAll("Attachment/GetAllFiltered",s)}deleteAttachment(e){return super.delete("Attachment/Delete",e)}};r.\u0275fac=function(i){return new(i||r)(m(k))},r.\u0275prov=p({token:r,factory:r.\u0275fac});let t=r;return t})(),h=function(t){return t[t.None=0]="None",t[t.Notify=1]="Notify",t[t.ReloadOneData=2]="ReloadOneData",t[t.ReloadMultiData=3]="ReloadMultiData",t}(h||{});var Re=["png","jpeg","jpg","gif"],je=["mp4","mkv","webm"];var Yt=(()=>{let r=class r extends Fe{constructor(){super(...arguments),this.defaultPhoto="../../../assets/images/not-found.png",this.url="upload/",this.defaultFileRoute=(e,i)=>this.getApiPath()+"file/"+i+e,this.getFileByNameView=e=>this.defaultFileRoute(e,"stream-file"),this.getFileByNameDownload=e=>this.defaultFileRoute(e,"download-file"),this.saveFile=e=>this.uploadFile(e,"single-file"),this.saveFiles=e=>this.uploadFile(e,"multiple-file"),this.getBaseUrl=()=>g?.API_PATH,this.getBaseUrlIH=()=>this.getBaseUrl()+g?.BASE_URL_IH,this.getBaseUrlMedia=()=>this.getBaseUrl()+g?.BASE_URL_MEDIA,this.getBaseUrlStreaming=()=>this.getBaseUrl()+g?.BASE_URL_STREAMING_MEDIA,this.imageTypeValidation=e=>Re.includes(e),this.videoTypeValidation=e=>je.includes(e),this.imageSrc=({md5:e})=>e?this.getBaseUrlMedia()?.replace("[src]",e):this.defaultPhoto,this.videoSrc=({md5:e})=>e?this.getBaseUrlStreaming()?.replace("[src]",e):this.defaultPhoto}createFile(e){return this.fileData("Attachment",e)}updateFile(e){let i=`Attachment/${e.id}`;return this.updateData(e)}imageSrcIH(e){if(e&&e.md5){let i=`${e.md5}.${e.extension}`;return this.getBaseUrlIH()+i+"&canvas=500x500"}else return this.defaultPhoto}};r.\u0275fac=(()=>{let e;return function(n){return(e||(e=de(r)))(n||r)}})(),r.\u0275prov=p({token:r,factory:r.\u0275fac});let t=r;return t})();export{Ge as a,V as b,Me as c,Ve as d,Oe as e,Fe as f,Yt as g,lt as h,ct as i,dt as j,pt as k};
