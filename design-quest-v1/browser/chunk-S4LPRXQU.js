import{e as N}from"./chunk-5SHEUPML.js";import{$a as R,$c as z,Ae as he,Be as _e,Ca as l,Ce as ge,Da as a,Ea as C,Ee as Ce,Fa as G,Ga as F,Ha as S,Ib as J,Ka as x,Ma as p,Mb as Q,Pb as Y,Qd as ne,T as b,Va as j,Wa as f,Xa as A,Xb as q,Y as u,Ya as O,Z as h,Za as W,Zb as D,_a as L,a as P,ab as k,b as $,ca as v,cd as ee,ce as oe,de as re,ea as _,ed as te,g as U,ha as s,ia as y,ib as K,jd as ie,me as T,ne as se,ob as X,oe as le,qb as Z,ra as g,rb as V,ta as c,te as ae,ue as ce,ve as de,we as me,xe as pe,ye as fe,ze as ue}from"./chunk-M3I5HJ6Y.js";var I=class{constructor(i=""){this.field=i,this.emptyMessage="Empty Field",this.field=i}Capitalize(){this.field?this.field=this.field.charAt(0).toUpperCase()+this.field.slice(1):this.field=this.field||this.emptyMessage}Uppercase(){this.field?this.field=this.field.toUpperCase():this.field=this.field||this.emptyMessage}Lowercase(){this.field?this.field=this.field.toLowerCase():this.field=this.field||this.emptyMessage}ToNumber(){this.field?this.field=Number(this.field):this.field=this.field||this.emptyMessage}ToString(){this.field?this.field=this.field.toString():this.field=this.field||this.emptyMessage}GetField(){return this.field||""}};var M=class{constructor(i){this.output={},this.converted=()=>this.output,this.convert(i)}convert(i){let r=Object.getOwnPropertyNames(i);for(let e of r){let t=new I(e);switch(this.output[e]=e,!0){case i[e].capitalize:t.Capitalize();break;case i[e].upperCase:t.Uppercase();break;case i[e].lowerCase:t.Lowercase();break;case i[e].toNumber:t.ToNumber();break;case i[e].toString:t.ToString();break;default:break}this.output[e]=t.GetField()}}};var E=class{constructor(i,r,e,t,o=[]){this.customColumn=i,this.defaultColumns=r,this.sortDirection=e,this.sortColumn=t,this.allColumns=o,this.allColumns=o.length&&o||[this.customColumn,...this.defaultColumns]}};var Ke=(()=>{let i=class i{constructor(e){this.injector=e,this.data=[],this.routerName="N/A",this.selectedItems=[],this.searchText="",this.progress=1,this.isSelected=t=>this.selectedItems.findIndex(o=>o==t)>-1,this.convertDataToTreeNode=t=>t&&t.length&&t.map(o=>({data:$(P({},o),{editable:!0,deletable:!0})}))||[],this.getRedirectURL=t=>{let m=window.location.href.split("-").pop();this.router.navigate([`/admin/${m}/form-${m}/${t||"new"}`])},this.log=t=>console.info("Logger, value => ",t),this.notify=e.get(N),this.router=e.get(D)}ngOnInit(){this.service.setPagination(),this.model?(this.loadSettings(),this.service.refreshData(),this.notify.show(null)):console.info("Model Not Found")}ngOnDestroy(){}setPage(e,t){let o=this.service.pagination.pageCount,w=this.service.pagination.page+e;w>0&&w<=o&&(this.service.pagination.page=w,this.service.refreshData()),this.progress=this.service.pagination.page*100/o,e&&e==1?t.flipped=!0:e==-1&&(t.flipped=!1)}onFilterConfirm(e){this.service.onFilterConfirm(e)}selectedConfirm(e){let{data:t}=e,{id:o}=this.selected||{};o&&o==t.id&&this.router.navigate([this.getRedirectURL(t.id)]),this.selected=t}onCreateConfirm(e){let t=e.data!=e.newData;this.service.createData(e.newData)}onEditConfirm(e){let t=e.data!=e.newData;this.service.updateData(e.newData)}onDeleteConfirm(e){if(!e||!e.id)return console.error("Nothing to Delete");window.confirm("Are you sure you want to delete?")&&this.service.deleteData(e.id)}toggleSelection(e){let t=this.selectedItems.find(o=>o==e);t?this.selectedItems.splice(t,1):this.selectedItems.push(e)}loadSettings(){this.notifyParams=this.notify.getDefaultValues(),this.changeTitles(),this.setHtmlTypes(),this.setCustomSizes(),this.setBlockedColumns()}changeTitles(){this.service.columns=new M(this.model).converted();let e=Object.getOwnPropertyNames(this.model)||[],t=e.length&&e.filter(o=>!this.model[o].hide);this.service.updateSourceData(new E("Actions",t||[],T.NONE))}setHtmlTypes(){}setCustomSizes(){}setBlockedColumns(){}};i.\u0275fac=function(t){return new(t||i)(y(v))},i.\u0275cmp=b({type:i,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,o){},encapsulation:2});let n=i;return n})();function Se(n,i){if(n&1&&(l(0,"nb-option",7),f(1),a()),n&2){let r=i.$implicit,e=i.index;c("value",r),s(),W(" ",e+1,": ",r," ")}}function ve(n,i){n&1&&C(0,"tr",19)}function Te(n,i){n&1&&C(0,"tr",20)}function Ne(n,i){if(n&1&&(l(0,"th",21),f(1),a()),n&2){let r=p(2);c("nbSortHeader",r.getSortDirection(r.sourceData.customColumn)),s(),O(" ",r.columns[r.sourceData.customColumn]||r.sourceData.customColumn," ")}}function Ie(n,i){if(n&1){let r=S();l(0,"td",22)(1,"nb-fs-icons",23),x("onEdit",function(t){u(r);let o=p(2);return h(o.getRedirectURL(t))})("onDelete",function(){let t=u(r).$implicit,o=p(2);return h(o.onDelete.emit(t.data))}),a()()}if(n&2){let r=i.$implicit;s(),c("id",r.data.id)}}function Me(n,i){if(n&1&&(l(0,"th",21),f(1),a()),n&2){let r=p().$implicit,e=p(2);c("nbSortHeader",e.getSortDirection(r)),s(),O(" ",e.columns[r]||e.getColumnName(r)," ")}}function Ee(n,i){if(n&1&&(l(0,"td",22),f(1),a()),n&2){let r=i.$implicit,e=p().$implicit;s(),A(r.data[e]||"-")}}function Be(n,i){if(n&1&&(G(0,24),g(1,Me,2,2,"th",16)(2,Ee,2,1,"td",17),F()),n&2){let r=i.$implicit,e=i.index,t=p(2);c("nbTreeGridColumnDef",r)("showOn",t.getShowOn(e))}}function Ge(n,i){if(n&1){let r=S();l(0,"nb-card",3)(1,"nb-card-body")(2,"div",4)(3,"div")(4,"label",5),f(5,"Search Field"),a(),C(6,"br"),l(7,"nb-select",6),k("selectedChange",function(t){u(r);let o=p();return R(o.filter.field,t)||(o.filter.field=t),h(t)}),l(8,"nb-option",7),f(9,"Reset"),a(),g(10,Se,2,3,"nb-option",8),a()(),l(11,"div")(12,"label",9),f(13,"Search Key"),a(),C(14,"br"),l(15,"input",10),x("ngModelChange",function(t){u(r);let o=p();return h(o.updateFilter(t))}),k("ngModelChange",function(t){u(r);let o=p();return R(o.filter.key,t)||(o.filter.key=t),h(t)}),a()()(),l(16,"label",11),f(17,"List View"),a(),C(18,"br"),l(19,"table",12),x("sort",function(t){u(r);let o=p();return h(o.updateSort(t))}),g(20,ve,1,0,"tr",13)(21,Te,1,0,"tr",14),G(22,15),g(23,Ne,2,2,"th",16)(24,Ie,2,1,"td",17),F(),g(25,Be,3,2,"ng-container",18),a()()()}if(n&2){let r=p();s(7),L("selected",r.filter.field),s(),c("value",null),s(2),c("ngForOf",r.filterKeys),s(5),L("ngModel",r.filter.key),s(4),c("nbTreeGrid",r.source)("nbSort",r.source),s(),c("nbTreeGridHeaderRowDef",r.sourceData.allColumns),s(),c("nbTreeGridRowDefColumns",r.sourceData.allColumns),s(),c("nbTreeGridColumnDef",r.sourceData.customColumn),s(3),c("ngForOf",r.sourceData.defaultColumns)}}function Fe(n,i){if(n&1){let r=S();l(0,"nb-icon",3),x("click",function(){u(r);let t=p();return h(t.onDelete.emit(t.id))}),a()}}function Oe(n,i){n&1&&C(0,"nb-tree-grid-row-toggle")}var rt=(()=>{let i=class i{constructor(e){this.router=e,this.onSelected=new _,this.onDelete=new _,this.onFilter=new _,this.onEdit=new _,this.routerName="",this.model={},this.filterKeys=[],this.filter={use:!0,field:"",key:""},this.getRedirectURL=t=>{let m=window.location.href.split("-").pop();this.router.navigate([`/admin/${m}/form-${m}/${t||"new"}`])}}ngOnInit(){if(this.model&&!this.filterKeys.length){this.filterKeys=[];let e=Object.getOwnPropertyNames(this.model);for(let t of e)t&&this.model[t]&&this.model[t].filter&&this.filterKeys.push(t)}}updateSort(e){this.sourceData.sortDirection=e.direction,this.sourceData.sortColumn=e.column}getSortDirection(e){return this.sourceData.sortColumn===e?this.sourceData.sortDirection:T.NONE}getShowOn(e){return 400+100*e}getColumnName(e){return this.columns&&this.columns[e]||e}updateFilter(e){this.filter.key=e,this.onFilter.emit(this.filter)}};i.\u0275fac=function(t){return new(t||i)(y(D))},i.\u0275cmp=b({type:i,selectors:[["base-list-style"]],inputs:{source:"source",columns:"columns",sourceData:"sourceData",selectedItems:"selectedItems",routerName:"routerName",model:"model"},outputs:{onSelected:"onSelected",onDelete:"onDelete",onFilter:"onFilter",onEdit:"onEdit"},decls:4,vars:1,consts:[["class","textCenter",4,"ngIf"],["nbButton","","status","success","shape","semi-round",3,"click"],["icon","person-add-outline"],[1,"textCenter"],["id","filter",1,"mb-2",2,"display","flex","justify-content","space-between"],["for","key-selector",1,"search-label"],["placeholder","Field to filter","id","key-selector",3,"selectedChange","selected"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","search",1,"search-label"],["nbInput","","id","search",1,"search-input",3,"ngModelChange","ngModel"],["for","table",1,"search-label"],["id","table",3,"sort","nbTreeGrid","nbSort"],["nbTreeGridHeaderRow","",4,"nbTreeGridHeaderRowDef"],["nbTreeGridRow","",4,"nbTreeGridRowDef","nbTreeGridRowDefColumns"],[3,"nbTreeGridColumnDef"],["nbTreeGridHeaderCell","",3,"nbSortHeader",4,"nbTreeGridHeaderCellDef"],["nbTreeGridCell","",4,"nbTreeGridCellDef"],[3,"nbTreeGridColumnDef","showOn",4,"ngFor","ngForOf"],["nbTreeGridHeaderRow",""],["nbTreeGridRow",""],["nbTreeGridHeaderCell","",3,"nbSortHeader"],["nbTreeGridCell",""],[3,"onEdit","onDelete","id"],[3,"nbTreeGridColumnDef","showOn"]],template:function(t,o){t&1&&(g(0,Ge,26,10,"nb-card",0),l(1,"button",1),x("click",function(){return o.getRedirectURL()}),C(2,"nb-icon",2),f(3,"Add New"),a()),t&2&&c("ngIf",o.source&&o.sourceData)},dependencies:()=>[Z,V,J,Q,Y,te,ee,z,ne,ie,ae,ce,fe,me,_e,de,ue,pe,ge,he,se,le,re,oe,Le],styles:[`.textCenter[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   nb-card[_ngcontent-%COMP%]{transform:translateZ(0)}





`]});let n=i;return n})(),Le=(()=>{let i=class i{constructor(){this.onSelected=new _,this.onDelete=new _,this.onEdit=new _}isDeletable(){return this.deletable}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=b({type:i,selectors:[["nb-fs-icons"]],inputs:{id:"id",deletable:"deletable"},outputs:{onSelected:"onSelected",onDelete:"onDelete",onEdit:"onEdit"},decls:5,vars:2,consts:[["deletebleIcon",""],["nbButton","","icon","edit-outline",3,"click"],[4,"ngIf","ngIfElse"],["nbButton","","icon","trash-outline",3,"click"]],template:function(t,o){if(t&1){let m=S();l(0,"nb-icon",1),x("click",function(){return u(m),h(o.onEdit.emit(o.id))}),a(),f(1," - "),g(2,Fe,1,0,"ng-template",null,0,K)(4,Oe,1,0,"nb-tree-grid-row-toggle",2)}if(t&2){let m=j(3);s(4),c("ngIf",o.isDeletable())("ngIfElse",m)}},dependencies:[V,z,Ce],encapsulation:2});let n=i;return n})();var B=class{constructor(){this.defaultPhotoUrl="../../../assets/images/not-found.png",this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.loadDefault()}extractBase64FromUrl(i){let r=new Error("Error on CTX from base64 Extractor");return new Promise((e,t)=>{let o=new Image;o.crossOrigin="anonymous",o.onload=()=>{this.canvas.height=o.height,this.canvas.width=o.width,this.ctx.drawImage(o,0,0),e(this.canvas.toDataURL("image/jpeg"))},o.onerror=m=>{t(m||r)},o.src=i})}loadDefault(){return U(this,null,function*(){this.defaultNotFoundImage=yield this.extractBase64FromUrl(this.defaultPhotoUrl)})}};var ft=(()=>{let i=class i{constructor(e){this.injector=e,this.extractor=new B,this.relations={},this.getData=t=>{if(!this.id||this.id=="new"){this.service.data=t;return}this.service.getOneData(this.id),this.notify.show(null)},this.exist=()=>this.service.data&&this.service.data.id,this.onDelete=()=>this.onDeleteConfirm(this.service.data),this.onSave=()=>this.exist()?this.onEditConfirm(this.service.data):this.onCreateConfirm(this.service.data),this.onBack=()=>{let[t,o,m,w,H,Re,...ke]=window.location.href.split("/");this.router.navigate([`/${w}/${H}/smart-${H}`])},this.route=e.get(q),this.notify=e.get(N),this.location=e.get(X),this.router=e.get(D),this.id=this.route.snapshot.params.id}ngOnInit(){}ngOnDestroy(){}onEditConfirm(e){this.service.updateData(e)}onCreateConfirm(e){this.service.createData(e)}onDeleteConfirm(e){if(!e||!e.id)return console.error("Nothing to Delete");window.confirm("Are you sure you want to delete?")&&this.service.deleteData(e.id)}loadSettings(){this.service.data={}}compareByIds(e,t){return e&&t&&e.productId==t.productId&&e.categoryId==t.categoryId&&!0}};i.\u0275fac=function(t){return new(t||i)(y(v))},i.\u0275cmp=b({type:i,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,o){},encapsulation:2});let n=i;return n})();var d=class{};var xe=class extends d{},St=()=>new Object({id:{upperCase:!0,filter:!1},login:{capitalize:!0,filter:!0},role:{capitalize:!0,filter:!1}});var we=class extends d{},Nt=()=>new Object({id:{upperCase:!0,filter:!1,show:!0},code:{capitalize:!0,filter:!0},name:{capitalize:!0,filter:!0},description:{capitalize:!0,filter:!0,hide:!0},price:{capitalize:!0,filter:!1},categories:{hide:!0}});var ye=class extends d{},Et=()=>new Object({id:{upperCase:!0,filter:!1,show:!0},code:{capitalize:!0,filter:!0},name:{capitalize:!0,filter:!0},color:{capitalize:!0,filter:!0},description:{capitalize:!0,filter:!0,hide:!0},parentCategory:{capitalize:!1,filter:!1,hide:!0},parentCategoryId:{capitalize:!1,filter:!1,hide:!0}});var De=class extends d{};export{xe as a,St as b,we as c,Nt as d,ye as e,Et as f,De as g,Ke as h,rt as i,ft as j};
